/**
 * TotalStorage
 *
 * Copyright (c) 2012 Jared Novack & Upstatement (upstatement.com)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Total Storage is the conceptual the love child of jStorage by Andris Reinman, 
 * and Cookie by Klaus Hartl -- though this is not connected to either project.
 *
 * Ported to AngularJS by Aditya V. Mukherjee // http://adityamukherjee.com/
 *
 * Updated to the lastest version of $.totalStorage(2a11d24030 * Jared Novack jarednova authored on Jan 22) 
 * by Alexey S. Mirniy // https://github.com/pharmazone
 *
 * @name totalStorage
 * @cat Plugins/Cookie
 * @author Jared Novack/jared@upstatement.com
 * @author Aditya V. Mukherjee/aditya@adityamukherjee.com
 * @author Alexey S. Mirniy/ github.com/pharmazone
 * @version 0.1
 */
 
angular.module("totalStorage",[]).factory("totalStorage",function(){var a,b,c="test";if("localStorage" in window){try{b=(typeof window.localStorage==="undefined")?undefined:window.localStorage;if(typeof b=="undefined"||typeof window.JSON=="undefined"){a=false;}else{a=true;}window.localStorage.setItem(c,"1");window.localStorage.removeItem(c);}catch(e){a=false;}}var d=function(g,h,f){return d.impl.init(g,h);};d.setItem=function(f,g){return d.impl.setItem(f,g);};d.getItem=function(f){return d.impl.getItem(f);};d.getAll=function(){return d.impl.getAll();};d.deleteItem=function(f){return d.impl.deleteItem(f);};d.impl={init:function(f,g){if(typeof g!="undefined"){return this.setItem(f,g);}else{return this.getItem(f);}},setItem:function(g,h){if(!a){try{$.cookie(g,h);return h;}catch(i){console.log("Local Storage not supported by this browser. Install the cookie plugin on your site to take advantage of the same functionality. You can get it at https://github.com/carhartl/jquery-cookie");}}var f=JSON.stringify(h);b.setItem(g,f);return this.parseResult(f);},getItem:function(f){if(!a){try{return this.parseResult($.cookie(f));}catch(h){return null;}}var g=b.getItem(f);return this.parseResult(g);},deleteItem:function(f){if(!a){try{$.cookie(f,null);return true;}catch(g){return false;}}b.removeItem(f);return true;},getAll:function(){var f=[];if(!a){try{var l=document.cookie.split(";");for(var k=0;k<l.length;k++){var n=l[k].split("=");var h=n[0];f.push({key:h,value:this.parseResult($.cookie(h))});}}catch(m){return null;}}else{for(var g in b){if(g.length){f.push({key:g,value:this.parseResult(b.getItem(g))});}}}return f;},parseResult:function(g){var f;try{f=JSON.parse(g);if(typeof f=="undefined"){f=g;}if(f=="true"){f=true;}if(f=="false"){f=false;}if(parseFloat(f)==f&&typeof f!="object"){f=parseFloat(f);}}catch(h){f=g;}return f;}};return d;});